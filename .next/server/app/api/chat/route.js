"use strict";(()=>{var e={};e.id=744,e.ids=[744],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},7066:(e,s,t)=>{t.r(s),t.d(s,{originalPathname:()=>S,patchFetch:()=>O,requestAsyncStorage:()=>f,routeModule:()=>m,serverHooks:()=>y,staticGenerationAsyncStorage:()=>w});var r={};t.r(r),t.d(r,{GET:()=>g,POST:()=>h});var a=t(9303),n=t(8716),i=t(670),o=t(2048),p=t(5315),c=t.n(p);let u=c().join(process.cwd(),"public","chat"),l=c().join(u,"messages.json");async function d(){try{await o.promises.mkdir(u,{recursive:!0});try{await o.promises.access(l)}catch{await o.promises.writeFile(l,JSON.stringify([],null,2))}}catch(e){console.error("Error ensuring chat file:",e)}}async function g(){try{await d();let e=await o.promises.readFile(l,"utf-8"),s=JSON.parse(e);return new Response(JSON.stringify({success:!0,messages:s.sort((e,s)=>new Date(e.timestamp)-new Date(s.timestamp))}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error reading chat:",e),new Response(JSON.stringify({success:!1,error:e.message}),{status:500,headers:{"Content-Type":"application/json"}})}}async function h(e){try{await d();let s=await e.json();if(!s.sender||!s.message||!s.timestamp)return new Response(JSON.stringify({success:!1,error:"Missing required fields"}),{status:400,headers:{"Content-Type":"application/json"}});let t=!0===s.isGuest;t||["ZOHA","SECRET_DEV"].includes(s.sender)||console.log("Message from:",s.sender,"isGuest:",t);let r={...s,receivedAt:new Date().toISOString(),ip:e.headers.get("x-forwarded-for")||e.headers.get("x-real-ip")||"unknown"},a=await o.promises.readFile(l,"utf-8"),n=JSON.parse(a);return n.push(r),n.length>500&&n.shift(),await o.promises.writeFile(l,JSON.stringify(n,null,2)),console.log("\uD83D\uDCAC Message saved:",r),new Response(JSON.stringify({success:!0,message:"Message saved",totalMessages:n.length}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error saving message:",e),new Response(JSON.stringify({success:!1,error:e.message}),{status:500,headers:{"Content-Type":"application/json"}})}}let m=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"D:\\SECRET PROJECT\\app\\api\\chat\\route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:f,staticGenerationAsyncStorage:w,serverHooks:y}=m,S="/api/chat/route";function O(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:w})}},9303:(e,s,t)=>{e.exports=t(517)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[948],()=>t(7066));module.exports=r})();